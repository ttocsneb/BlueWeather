{% extends "layouts/base.html" %}

{% block content %}
<body id="page-top" class="sidebar-toggled">
    <!-- Navigation -->
    <nav class="navbar navbar-expand navbar-dark bg-dark static-top">
        
        <a class="navbar-brand mr-1" href="{{ url_for('main.home') }}">Blue Weather</a>

        <button class="btn btn-link btn-sm text-white order-1 order-sm-0" id="sidebarToggle" href="#">
            <i class="fas fa-bars"></i>
        </button>
        
        <!-- Navbar -->
        <ul class="navbar-nav ml-auto">

            {% if current_user.is_authenticated %}

                <li class="nav-item dropdown mx-1">
                    <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <i class="fas fa-user-circle fa-fw"></i>
                        {{ current_user.username }}
                    </a>
                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="userDropdown">
                        <a class="dropdown-item" href="{{ url_for('users.settings') }}">Settings</a>
                        {% if current_user.permissions.change_perm or current_user.permissions.add_user %}
                            <div class="dropdown-divider"></div>
                        {% endif %}
                        {% if current_user.permissions.change_perm %}
                            <a class="dropdown-item" href="{{ url_for('users.privileges') }}">
                                Edit Permissions
                            </a>
                        {% endif %}
                        {% if current_user.permissions.add_user %}
                            <a class="dropdown-item" href="{{ url_for('users.register') }}">
                                Register User
                            </a>
                        {% endif %}
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="#" data-toggle="modal" data-target="#logoutModal">Logout</a>
                    </div>
                </li>

            {% else %}

                <li class="nav-item mx-1">
                    <a class="nav-link" href="{{ url_for('users.login') }}">
                        <i class="fas fa-fw fa-sign-in-alt"></i>
                    </a>
                </li>

            {% endif %}


        </ul>
    </nav>

    <div id="wrapper">
        <!-- Side bar -->
        <ul class="sidebar navbar-nav toggled" id="fix-top">
            {% for item in sidebar %}
                {% if item == 'divider' %}
                    <div class="sidebar-divider"></div>
                {% else %}
                    
                    <li class="nav-item {% if item.active %}active{% endif %}">
                        <a class="nav-link" href="{{ item.url }}">
                            {% if item.icon %}
                                <i class="{{ item.icon }}"></i>
                            {% endif %}
                            {% if item.name %}
                                <span>{{ item.name }}</span>
                            {% endif %}
                        </a>
                    </li>
                {% endif %}

            {% endfor %}
        </ul>

        <!-- Content -->
        <div id="content-wrapper">
        
            <div class="container-fluid">
                
                {% include "/includes/messages.jinja2" %}
                
                {% if breadcrumbs %}
                    <!-- Breadcrumb Page Title -->
                    <ol class="breadcrumb">
                        {% for crumb in breadcrumbs %}
                            {% if crumb.url %}
                                <li class="breadcrumb-item">
                                    <a href="{{ crumb.url }}">{{ crumb.name }}</a>
                                </li>
                            {% else %}
                                <li class="breadcrumb-item active">{{ crumb.name }}</li>
                            {% endif %}
                        {% endfor %}
                    </ol>
                {% endif %}
                
                
                <!-- Body -->
                
                {% block body %}{% endblock %}

            
            </div>
            
            <footer class="sticky-footer">
                <div class="container my-auto">
                    <div class="copyright text-center my-auto">
                        BlueWeather
                    </div>
                </div>
            </footer>
            
            
        </div>
    </div>

    {% if current_user.is_authenticated %}
        <!-- Logout Modal-->
        <div class="modal fade" id="logoutModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Ready to Leave?</h5>
                    
                    <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">Ã—</span>
                    </button>
                </div>
                <div class="modal-body">Select "Logout" below if you are ready to end your current session.</div>
                    <div class="modal-footer">
                        <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
                        <a class="btn btn-primary" role="button" href="{{ url_for('users.logout') }}">Logout</a>
                    </div>
                </div>
            </div>
        </div>
    {% endif %}

    

    <!-- No need to close the body tag, layouts/base does that for us -->
{% endblock content %}

{% block scripts %}
{% endblock %}
